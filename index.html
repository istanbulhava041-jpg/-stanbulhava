<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ä°STANBUL HAVA DURUMU</title>
    <style>
        body { background: #0f172a; color: white; font-family: sans-serif; margin: 0; padding: 10px; display: flex; flex-direction: column; align-items: center; }
        .card { background: rgba(30, 41, 59, 0.9); border-radius: 15px; padding: 20px; width: 100%; max-width: 400px; margin-bottom: 10px; border: 1px solid #38bdf8; }
        select { width: 100%; padding: 12px; border-radius: 10px; background: #1e293b; color: white; border: 1px solid #38bdf8; font-size: 16px; margin-bottom: 15px; }
        #temp { font-size: 60px; font-weight: bold; text-align: center; margin: 10px 0; }
        #desc { text-align: center; color: #38bdf8; font-weight: bold; font-size: 20px; margin-bottom: 10px; }
        .day { display: flex; justify-content: space-between; align-items: center; padding: 10px 0; border-bottom: 1px solid rgba(255,255,255,0.1); }
        .day:last-child { border: none; }
        .menu-btn { background: none; border: 1px solid #38bdf8; color: #38bdf8; padding: 5px 10px; border-radius: 5px; cursor: pointer; margin-bottom: 10px; }
        #sidebar { position: fixed; left: -250px; top: 0; width: 250px; height: 100%; background: #0f172a; border-right: 2px solid #38bdf8; transition: 0.3s; padding: 20px; z-index: 100; }
        #sidebar.open { left: 0; }
        .sidebar-link { display: block; color: white; text-decoration: none; padding: 10px; border: 1px solid #38bdf8; margin-bottom: 10px; text-align: center; border-radius: 5px; }
    </style>
</head>
<body>

<div id="sidebar">
    <button onclick="toggleSide()" style="color:red; background:none; border:none; font-size:20px;">KAPAT [X]</button>
    <h3 style="color:#38bdf8">MENÃœ</h3>
    <a href="https://uym.ibb.gov.tr/" target="_blank" class="sidebar-link">ğŸš— Trafik Durumu</a>
    <a href="https://www.iski.gov.tr" target="_blank" class="sidebar-link">ğŸ’§ Barajlar</a>
    <a href="https://www.istanbuleczaciodasi.org.tr/nobetci-eczane" target="_blank" class="sidebar-link">ğŸ¥ NÃ¶betÃ§i Eczane</a>
    <p style="font-size:12px; margin-top:30px;">Ä°letiÅŸim:<br><b>istanbulhava041@gmail.com</b></p>
</div>

<button class="menu-btn" onclick="toggleSide()">â˜° MENÃœ</button>

<div class="card">
    <select id="ilceSec" onchange="verileriGetir()"></select>
    <div id="sehirAd" style="text-align:center; opacity:0.7;">Ä°STANBUL</div>
    <div id="temp">--Â°</div>
    <div id="desc">YÃœKLENÄ°YOR...</div>
</div>

<div class="card">
    <h4 style="margin:0 0 10px 0; color:#38bdf8;">7 GÃœNLÃœK TAHMÄ°N</h4>
    <div id="liste"></div>
</div>

<script>
const koordinatlar = {"Adalar":[40.87,29.13],"ArnavutkÃ¶y":[41.18,28.74],"AtaÅŸehir":[40.99,29.11],"AvcÄ±lar":[40.98,28.71],"BaÄŸcÄ±lar":[41.03,28.83],"BahÃ§elievler":[40.99,28.86],"BakÄ±rkÃ¶y":[40.97,28.87],"BaÅŸakÅŸehir":[41.09,28.80],"BayrampaÅŸa":[41.04,28.89],"BeÅŸiktaÅŸ":[41.04,29.00],"Beykoz":[41.11,29.09],"BeylikdÃ¼zÃ¼":[40.99,28.64],"BeyoÄŸlu":[41.03,28.97],"BÃ¼yÃ¼kÃ§ekmece":[41.02,28.59],"Ã‡atalca":[41.14,28.46],"Ã‡ekmekÃ¶y":[41.04,29.21],"Esenler":[41.04,28.87],"Esenyurt":[41.03,28.67],"EyÃ¼psultan":[41.04,28.93],"Fatih":[41.01,28.94],"GaziosmanpaÅŸa":[41.05,28.91],"GÃ¼ngÃ¶ren":[41.02,28.87],"KadÄ±kÃ¶y":[40.99,29.02],"KaÄŸÄ±thane":[41.08,28.97],"Kartal":[40.89,29.19],"KÃ¼Ã§Ã¼kÃ§ekmece":[41.00,28.77],"Maltepe":[40.93,29.14],"Pendik":[40.87,29.23],"Sancaktepe":[41.00,29.23],"SarÄ±yer":[41.16,29.05],"Silivri":[41.07,28.24],"Sultanbeyli":[40.96,29.26],"Sultangazi":[41.10,28.87],"Åile":[41.17,29.61],"ÅiÅŸli":[41.06,28.98],"Tuzla":[40.82,29.30],"Ãœmraniye":[41.03,29.10],"ÃœskÃ¼dar":[41.02,29.01],"Zeytinburnu":[40.99,28.90]};
const kodlar = {0:"â˜€ï¸ AÃ§Ä±k", 1:"ğŸŒ¤ï¸ AÃ§Ä±k", 2:"â›… Bulutlu", 3:"â˜ï¸ KapalÄ±", 45:"ğŸŒ«ï¸ Sisli", 61:"ğŸŒ§ï¸ YaÄŸmur", 71:"â„ï¸ Kar", 95:"âš¡ FÄ±rtÄ±na"};

function toggleSide() { document.getElementById('sidebar').classList.toggle('open'); }

window.onload = function() {
    const s = document.getElementById("ilceSec");
    Object.keys(koordinatlar).sort((a,b)=>a.localeCompare(b,'tr')).forEach(i => s.add(new Option(i, i)));
    s.value = "Fatih";
    verileriGetir();
};

async function verileriGetir() {
    const ilce = document.getElementById("ilceSec").value;
    const [lat, lon] = koordinatlar[ilce];
    document.getElementById("sehirAd").innerText = ilce.toUpperCase();
    document.getElementById("desc").innerText = "YÃœKLENÄ°YOR...";

    try {
        const url = `https://api.open-meteo.com/v1/forecast?latitude=${lat}&longitude=${lon}&current=temperature_2m,weather_code&daily=weather_code,temperature_2m_max,temperature_2m_min&timezone=auto`;
        const res = await fetch(url);
        const data = await res.json();

        // BugÃ¼n
        document.getElementById("temp").innerText = Math.round(data.current.temperature_2m) + "Â°";
        document.getElementById("desc").innerText = (kodlar[data.current.weather_code] || "AÃ§Ä±k").toUpperCase();

        // 7 GÃ¼nlÃ¼k Liste
        const liste = document.getElementById("liste");
        liste.innerHTML = "";
        const gunler = ["Pazar", "Pzt", "Sal", "Ã‡ar", "Per", "Cum", "Cmt"];
        
        data.daily.time.forEach((t, i) => {
            const gunAdi = i === 0 ? "BugÃ¼n" : gunler[new Date(t).getDay()];
            const ikon = kodlar[data.daily.weather_code[i]] ? kodlar[data.daily.weather_code[i]].split(' ')[0] : "â˜€ï¸";
            liste.innerHTML += `
                <div class="day">
                    <span>${gunAdi}</span>
                    <span style="font-size:20px">${ikon}</span>
                    <span><b>${Math.round(data.daily.temperature_2m_max[i])}Â°</b> / ${Math.round(data.daily.temperature_2m_min[i])}Â°</span>
                </div>`;
        });
    } catch (e) {
        document.getElementById("desc").innerText = "HATA! TEKRAR DENENÄ°YOR...";
        setTimeout(verileriGetir, 2000);
    }
}
</script>
</body>
</html>
