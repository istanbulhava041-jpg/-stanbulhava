<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>ƒ∞STANBUL HAVA DURUMU</title>
    <style>
        :root { --main: #0f172a; --card: rgba(30, 41, 59, 0.95); --blue: #38bdf8; --neon: #00f2ff; }
        * { box-sizing: border-box; margin: 0; padding: 0; font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif; }
        body { background: var(--main); color: white; min-height: 100vh; padding: 10px; transition: 0.5s; }
        
        /* Arka Plan Renkleri */
        body.sunny { background: linear-gradient(to bottom, #0ea5e9, #0f172a); }
        body.cloudy { background: linear-gradient(to bottom, #475569, #0f172a); }
        body.rainy { background: linear-gradient(to bottom, #1e293b, #020617); }
        body.night { background: linear-gradient(to bottom, #020617, #000000); }

        .header { display: flex; justify-content: space-between; align-items: center; padding: 10px; margin-bottom: 10px; }
        .btn-menu { background: none; border: 1px solid var(--blue); color: var(--blue); padding: 8px 15px; border-radius: 8px; font-weight: bold; }
        
        .main-card { background: var(--card); border-radius: 20px; padding: 25px; text-align: center; border: 1px solid rgba(255,255,255,0.1); margin-bottom: 15px; }
        select { width: 100%; padding: 12px; border-radius: 10px; background: #1e293b; color: white; border: 1px solid var(--blue); font-size: 16px; margin-bottom: 20px; }
        
        #temp { font-size: 72px; font-weight: 800; margin: 10px 0; }
        #desc { color: var(--neon); font-size: 20px; font-weight: bold; text-transform: uppercase; }

        .forecast-card { background: var(--card); border-radius: 20px; padding: 15px; border: 1px solid rgba(255,255,255,0.1); }
        .day-row { display: flex; justify-content: space-between; align-items: center; padding: 12px 5px; border-bottom: 1px solid rgba(255,255,255,0.05); }
        .day-row:last-child { border: none; }

        /* Men√º Paneli */
        #menu-panel { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: var(--main); z-index: 999; padding: 30px; }
        .menu-item { display: block; padding: 15px; border: 1px solid var(--blue); color: white; text-decoration: none; border-radius: 12px; margin-bottom: 15px; text-align: center; font-weight: bold; }
    </style>
</head>
<body id="bg">

<div id="menu-panel">
    <button onclick="toggleMenu()" style="float: right; color: red; background: none; border: none; font-size: 24px;">‚úñ</button>
    <h2 style="margin-bottom: 30px; color: var(--blue);">MEN√ú</h2>
    <a href="https://uym.ibb.gov.tr/" target="_blank" class="menu-item">üöó Canlƒ± Trafik</a>
    <a href="https://www.iski.gov.tr" target="_blank" class="menu-item">üíß Baraj Doluluk</a>
    <a href="https://www.istanbuleczaciodasi.org.tr/nobetci-eczane" target="_blank" class="menu-item">üè• N√∂bet√ßi Eczaneler</a>
    <div style="margin-top: 50px; border-top: 1px solid rgba(255,255,255,0.1); padding-top: 20px; font-size: 14px;">
        ƒ∞leti≈üim: <br> <b>istanbulhava041@gmail.com</b>
    </div>
</div>

<div class="header">
    <button class="btn-menu" onclick="toggleMenu()">‚ò∞ MEN√ú</button>
    <div id="clock" style="font-weight: bold; color: var(--neon);">00:00</div>
</div>

<div class="main-card">
    <select id="distSelect" onchange="loadData()"></select>
    <div id="locName" style="opacity: 0.6; font-size: 14px; letter-spacing: 2px;">ƒ∞STANBUL</div>
    <div id="temp">--¬∞</div>
    <div id="desc">Y√ºkleniyor...</div>
</div>

<div class="forecast-card">
    <h3 style="font-size: 14px; color: var(--blue); margin-bottom: 15px; padding-left: 5px;">7 G√úNL√úK TAHMƒ∞N</h3>
    <div id="forecast-list"></div>
</div>

<script>
const coords = {"Adalar":[40.87,29.13],"Arnavutk√∂y":[41.18,28.74],"Ata≈üehir":[40.99,29.11],"Avcƒ±lar":[40.98,28.71],"Baƒücƒ±lar":[41.03,28.83],"Bah√ßelievler":[40.99,28.86],"Bakƒ±rk√∂y":[40.97,28.87],"Ba≈üak≈üehir":[41.09,28.80],"Bayrampa≈üa":[41.04,28.89],"Be≈üikta≈ü":[41.04,29.00],"Beykoz":[41.11,29.09],"Beylikd√ºz√º":[40.99,28.64],"Beyoƒülu":[41.03,28.97],"B√ºy√ºk√ßekmece":[41.02,28.59],"√áatalca":[41.14,28.46],"√áekmek√∂y":[41.04,29.21],"Esenler":[41.04,28.87],"Esenyurt":[41.03,28.67],"Ey√ºpsultan":[41.04,28.93],"Fatih":[41.01,28.94],"Gaziosmanpa≈üa":[41.05,28.91],"G√ºng√∂ren":[41.02,28.87],"Kadƒ±k√∂y":[40.99,29.02],"Kaƒüƒ±thane":[41.08,28.97],"Kartal":[40.89,29.19],"K√º√ß√ºk√ßekmece":[41.00,28.77],"Maltepe":[40.93,29.14],"Pendik":[40.87,29.23],"Sancaktepe":[41.00,29.23],"Sarƒ±yer":[41.16,29.05],"Silivri":[41.07,28.24],"Sultanbeyli":[40.96,29.26],"Sultangazi":[41.10,28.87],"≈ûile":[41.17,29.61],"≈ûi≈üli":[41.06,28.98],"Tuzla":[40.82,29.30],"√úmraniye":[41.03,29.10],"√úsk√ºdar":[41.02,29.01],"Zeytinburnu":[40.99,28.90]};
const wCodes = {0:"‚òÄÔ∏è A√ßƒ±k", 1:"üå§Ô∏è A√ßƒ±k", 2:"‚õÖ Bulutlu", 3:"‚òÅÔ∏è Kapalƒ±", 45:"üå´Ô∏è Sisli", 61:"üåßÔ∏è Yaƒümur", 71:"‚ùÑÔ∏è Kar", 95:"‚ö° Fƒ±rtƒ±na"};

function toggleMenu() { 
    const p = document.getElementById('menu-panel');
    p.style.display = p.style.display === 'block' ? 'none' : 'block';
}

window.onload = () => {
    const s = document.getElementById("distSelect");
    Object.keys(coords).sort((a,b)=>a.localeCompare(b,'tr')).forEach(d => s.add(new Option(d, d)));
    s.value = "Fatih";
    loadData();
    setInterval(() => {
        document.getElementById('clock').innerText = new Date().toLocaleTimeString('tr-TR',{hour:'2-digit',minute:'2-digit'});
    }, 1000);
};

async function loadData() {
    const dist = document.getElementById("distSelect").value;
    const [lat, lon] = coords[dist];
    document.getElementById("locName").innerText = dist.toUpperCase();

    try {
        const res = await fetch(`https://api.open-meteo.com/v1/forecast?latitude=${lat}&longitude=${lon}&current=temperature_2m,weather_code&daily=weather_code,temperature_2m_max,temperature_2m_min&timezone=auto`);
        const data = await res.json();

        document.getElementById("temp").innerText = Math.round(data.current.temperature_2m) + "¬∞";
        const code = data.current.weather_code;
        document.getElementById("desc").innerText = (wCodes[code] || "A√ßƒ±k").toUpperCase();

        // Arka Plan Ayarƒ±
        const h = new Date().getHours();
        const body = document.getElementById("bg");
        body.className = (h > 19 || h < 7) ? "night" : (code >= 61 ? "rainy" : (code >= 1 ? "cloudy" : "sunny"));

        // Liste
        const list = document.getElementById("forecast-list");
        list.innerHTML = "";
        const days = ["Pazar", "Pazartesi", "Salƒ±", "√áar≈üamba", "Per≈üembe", "Cuma", "Cumartesi"];
        
        data.daily.time.forEach((t, i) => {
            const dName = i === 0 ? "Bug√ºn" : days[new Date(t).getDay()];
            const icon = (wCodes[data.daily.weather_code[i]] || "‚òÄÔ∏è").split(' ')[0];
            list.innerHTML += `
                <div class="day-row">
                    <span style="width: 80px; font-weight: bold;">${dName}</span>
                    <span style="font-size: 22px;">${icon}</span>
                    <span style="width: 80px; text-align: right;">
                        <b>${Math.round(data.daily.temperature_2m_max[i])}¬∞</b> / <small>${Math.round(data.daily.temperature_2m_min[i])}¬∞</small>
                    </span>
                </div>`;
        });
    } catch (e) { document.getElementById("desc").innerText = "HATA!"; }
}
</script>
</body>
</html>
