<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Ä°STANBUL HAVA v22.1</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        :root { --bg: #020617; --card: rgba(15, 23, 42, 0.85); --accent: #38bdf8; --neon: #00f2ff; --warn: #f43f5e; --gold: #fbbf24; }
        * { box-sizing: border-box; margin: 0; padding: 0; transition: all 0.4s ease; }
        body { background: var(--bg); color: white; font-family: 'Segoe UI', sans-serif; min-height: 100vh; display: flex; flex-direction: column; align-items: center; }
        body.day { background: linear-gradient(180deg, #075985 0%, #020617 100%); }
        body.night { background: linear-gradient(180deg, #020617 0%, #000000 100%); }
        
        .alert-bar { width: 100%; background: var(--warn); color: white; padding: 6px; text-align: center; font-size: 12px; font-weight: bold; overflow: hidden; }
        .marquee { display: inline-block; animation: scroll 15s linear infinite; white-space: nowrap; }
        @keyframes scroll { 0% { transform: translateX(100%); } 100% { transform: translateX(-100%); } }

        .header { width: 100%; display: flex; align-items: center; justify-content: space-between; padding: 15px; background: rgba(15, 23, 42, 0.9); border-bottom: 2px solid var(--neon); position: sticky; top: 0; z-index: 1000; }
        .main { width: 100%; max-width: 480px; padding: 15px; display: flex; flex-direction: column; gap: 15px; }
        .glass { background: var(--card); backdrop-filter: blur(20px); border: 1px solid rgba(255, 255, 255, 0.1); border-radius: 20px; padding: 20px; }
        
        .index-grid { display: grid; grid-template-columns: repeat(3, 1fr); gap: 10px; }
        .index-card { background: rgba(255,255,255,0.05); padding: 10px; border-radius: 12px; text-align: center; border: 1px solid rgba(56,189,248,0.1); }
        .index-card small { font-size: 10px; opacity: 0.6; display: block; margin-bottom: 4px; }
        .index-card b { color: var(--neon); font-size: 13px; }

        #temp-val { font-size: 72px; font-weight: 900; margin: 5px 0; }
        select { width: 100%; padding: 14px; border-radius: 12px; background: #1e293b; color: white; border: 1px solid var(--accent); font-size: 16px; appearance: none; text-align: center; }
        
        .sidebar { position: fixed; top: 0; left: -100%; width: 280px; height: 100%; background: #0f172a; z-index: 2000; padding: 25px; border-right: 2px solid var(--neon); }
        .sidebar.open { left: 0; }
        .sidebar-btn { width: 100%; padding: 12px; margin-bottom: 10px; border-radius: 10px; border: 1px solid var(--accent); background: rgba(56,189,248,0.1); color: white; text-decoration: none; display: block; text-align: center; font-weight: bold; }
    </style>
</head>
<body id="bodyTag">

<div class="alert-bar"><div class="marquee">âš ï¸ Duyuru: Ä°stanbul genelinde rÃ¼zgar hÄ±zÄ± takibi aktif. Deniz suyu sÄ±caklÄ±ÄŸÄ± ortalama 12Â°C.</div></div>

<div id="sidebar" class="sidebar">
    <button onclick="toggleMenu()" style="float:right; background:none; border:none; color:var(--warn); font-size:30px;">Ã—</button>
    <h2 style="color:var(--neon); margin: 20px 0;">MENÃœ</h2>
    <a href="https://uym.ibb.gov.tr/" target="_blank" class="sidebar-btn">ğŸš— CanlÄ± Trafik</a>
    <a href="https://www.iski.gov.tr" target="_blank" class="sidebar-btn">ğŸ’§ Baraj Doluluk</a>
    <a href="https://www.istanbuleczaciodasi.org.tr/nobetci-eczane" target="_blank" class="sidebar-btn">ğŸ¥ NÃ¶betÃ§i Eczane</a>
    <div style="margin-top: 50px; border-top: 1px solid rgba(255,255,255,0.1); padding-top: 20px;">
        <small>Ä°letiÅŸim:</small><br>
        <b style="color:var(--accent); font-size:13px;">istanbulhava041@gmail.com</b>
    </div>
</div>

<div class="header">
    <button onclick="toggleMenu()" style="background:none; border:none; color:var(--neon); font-size:25px;">â˜°</button>
    <div id="clock" style="font-weight: bold; color: var(--gold);">00:00</div>
    <b style="color:var(--neon)">HAVA PRO</b>
</div>

<div class="main">
    <div class="glass">
        <select id="ilce" onchange="fetchData()"></select>
    </div>

    <div class="glass" style="text-align: center;">
        <div id="loc-name" style="font-size: 14px; opacity: 0.7; letter-spacing: 2px;">Ä°STANBUL</div>
        <div id="temp-val">--Â°</div>
        <div id="desc-val" style="font-size: 18px; font-weight: bold; color: var(--neon);">YÃœKLENÄ°YOR...</div>
    </div>

    <div class="index-grid">
        <div class="index-card"><small>ğŸ’¨ RÃœZGAR</small><b id="wind-val">--</b></div>
        <div class="index-card"><small>ğŸŒŠ DENÄ°Z</small><b>12Â°C</b></div>
        <div class="index-card"><small>â˜€ï¸ UV</small><b>DÃ¼ÅŸÃ¼k</b></div>
        <div class="index-card"><small>ğŸ’§ NEM</small><b id="hum-val">%--</b></div>
        <div class="index-card"><small>ğŸŒ¡ï¸ HÄ°SSEDÄ°LEN</small><b id="feel-val">--Â°</b></div>
        <div class="index-card"><small>ğŸŒ«ï¸ KALÄ°TE</small><b style="color:#4ade80">Ä°YÄ°</b></div>
    </div>

    <div class="glass">
        <canvas id="mainChart" style="height: 160px;"></canvas>
    </div>
</div>

<script>
const coords = {"Adalar":[40.87,29.13],"ArnavutkÃ¶y":[41.18,28.74],"AtaÅŸehir":[40.99,29.11],"AvcÄ±lar":[40.98,28.71],"BaÄŸcÄ±lar":[41.03,28.83],"BahÃ§elievler":[40.99,28.86],"BakÄ±rkÃ¶y":[40.97,28.87],"BaÅŸakÅŸehir":[41.09,28.80],"BayrampaÅŸa":[41.04,28.89],"BeÅŸiktaÅŸ":[41.04,29.00],"Beykoz":[41.11,29.09],"BeylikdÃ¼zÃ¼":[40.99,28.64],"BeyoÄŸlu":[41.03,28.97],"BÃ¼yÃ¼kÃ§ekmece":[41.02,28.59],"Ã‡atalca":[41.14,28.46],"Ã‡ekmekÃ¶y":[41.04,29.21],"Esenler":[41.04,28.87],"Esenyurt":[41.03,28.67],"EyÃ¼psultan":[41.04,28.93],"Fatih":[41.01,28.94],"GaziosmanpaÅŸa":[41.05,28.91],"GÃ¼ngÃ¶ren":[41.02,28.87],"KadÄ±kÃ¶y":[40.99,29.02],"KaÄŸÄ±thane":[41.08,28.97],"Kartal":[40.89,29.19],"KÃ¼Ã§Ã¼kÃ§ekmece":[41.00,28.77],"Maltepe":[40.93,29.14],"Pendik":[40.87,29.23],"Sancaktepe":[41.00,29.23],"SarÄ±yer":[41.16,29.05],"Silivri":[41.07,28.24],"Sultanbeyli":[40.96,29.26],"Sultangazi":[41.10,28.87],"Åile":[41.17,29.61],"ÅiÅŸli":[41.06,28.98],"Tuzla":[40.82,29.30],"Ãœmraniye":[41.03,29.10],"ÃœskÃ¼dar":[41.02,29.01],"Zeytinburnu":[40.99,28.90]};

function toggleMenu() { document.getElementById('sidebar').classList.toggle('open'); }

function updateClock() {
    const now = new Date();
    document.getElementById('clock').innerText = now.toLocaleTimeString('tr-TR', {hour:'2-digit', minute:'2-digit'});
    const hour = now.getHours();
    document.getElementById('bodyTag').className = (hour > 19 || hour < 7) ? 'night' : 'day';
}

window.onload = () => {
    const s = document.getElementById("ilce");
    Object.keys(coords).sort().forEach(i => s.add(new Option(i, i)));
    s.value = "Fatih";
    fetchData();
    setInterval(updateClock, 1000);
    updateClock();
};

async function fetchData() {
    const ilce = document.getElementById("ilce").value;
    const [lat, lon] = coords[ilce];
    document.getElementById("loc-name").innerText = ilce.toUpperCase();

    try {
        const res = await fetch(`https://api.open-meteo.com/v1/forecast?latitude=${lat}&longitude=${lon}&current=temperature_2m,relative_humidity_2m,apparent_temperature,weather_code,wind_speed_10m&hourly=temperature_2m&timezone=auto`);
        const data = await res.json();

        document.getElementById("temp-val").innerText = Math.round(data.current.temperature_2m) + "Â°";
        document.getElementById("hum-val").innerText = "%" + data.current.relative_humidity_2m;
        document.getElementById("feel-val").innerText = Math.round(data.current.apparent_temperature) + "Â°";
        document.getElementById("wind-val").innerText = Math.round(data.current.wind_speed_10m) + " km/s";
        
        const codes = {0:"AÃ§Ä±k", 1:"AÃ§Ä±k", 2:"Az Bulutlu", 3:"Bulutlu", 45:"Sisli", 61:"YaÄŸmurlu", 71:"KarlÄ±"};
        document.getElementById("desc-val").innerText = (codes[data.current.weather_code] || "AÃ§Ä±k").toUpperCase();

        drawChart(data.hourly.temperature_2m.slice(0, 24));
    } catch(e) { console.error("Hata!"); }
}

let myChart;
function drawChart(temps) {
    const ctx = document.getElementById('mainChart').getContext('2d');
    if(myChart) myChart.destroy();
    myChart = new Chart(ctx, {
        type: 'line',
        data: {
            labels: Array.from({length: 24}, (_, i) => i + ":00"),
            datasets: [{ data: temps, borderColor: '#00f2ff', tension: 0.4, fill: true, backgroundColor: 'rgba(0,242,255,0.05)', pointRadius: 0 }]
        },
        options: { responsive: true, maintainAspectRatio: false, plugins: { legend: { display: false } }, scales: { y: { display: false }, x: { ticks: { color: '#64748b', font: { size: 10 } } } } }
    });
}
</script>
</body>
</html>
