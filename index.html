<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Ä°STANBUL HAVA PRO</title>
    <style>
        * { box-sizing: border-box; margin: 0; padding: 0; font-family: 'Segoe UI', sans-serif; }
        body { background: #0f172a; color: white; display: flex; flex-direction: column; align-items: center; min-height: 100vh; padding: 15px; transition: 0.5s; }
        .container { width: 100%; max-width: 420px; display: flex; flex-direction: column; gap: 12px; }
        .card { background: rgba(30, 41, 59, 0.95); border-radius: 18px; padding: 20px; border: 1px solid rgba(255,255,255,0.1); width: 100%; box-shadow: 0 10px 25px rgba(0,0,0,0.3); }
        select { width: 100%; padding: 14px; border-radius: 12px; background: #1e293b; color: white; border: 1px solid #38bdf8; font-size: 16px; font-weight: bold; margin-bottom: 10px; outline: none; }
        #temp { font-size: 75px; font-weight: 900; text-align: center; margin: 5px 0; letter-spacing: -3px; }
        #desc { text-align: center; color: #00f2ff; font-weight: bold; font-size: 20px; text-transform: uppercase; margin-bottom: 15px; }
        .stats { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; margin-top: 10px; }
        .stat-box { background: rgba(255,255,255,0.05); padding: 10px; border-radius: 10px; text-align: center; font-size: 13px; border: 1px solid rgba(56, 189, 248, 0.2); }
        .stat-box b { display: block; font-size: 16px; color: #38bdf8; }
        .row { display: flex; justify-content: space-between; align-items: center; padding: 12px 5px; border-bottom: 1px solid rgba(255,255,255,0.05); }
        .row:last-child { border: none; }
        #menu { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: #0f172a; z-index: 999; padding: 30px; }
        .m-btn { display: block; width: 100%; padding: 15px; border: 1px solid #38bdf8; color: white; text-decoration: none; border-radius: 12px; margin-bottom: 12px; text-align: center; font-weight: bold; background: rgba(56, 189, 248, 0.1); }
    </style>
</head>
<body id="bg">

<div id="menu">
    <button onclick="toggleM()" style="float:right; color:#f43f5e; background:none; border:none; font-size:35px;">&times;</button>
    <h2 style="margin: 40px 0 20px 0; color:#38bdf8;">Ä°STANBUL PORTAL</h2>
    <a href="https://uym.ibb.gov.tr/" target="_blank" class="m-btn">ğŸš— CanlÄ± Trafik</a>
    <a href="https://www.iski.gov.tr" target="_blank" class="m-btn">ğŸ’§ Baraj Doluluk</a>
    <a href="https://www.istanbuleczaciodasi.org.tr/nobetci-eczane" target="_blank" class="m-btn">ğŸ¥ NÃ¶betÃ§i Eczaneler</a>
    <div style="margin-top: 50px; padding: 20px; border-top: 1px solid rgba(255,255,255,0.1);">
        <p style="opacity:0.6; font-size:12px;">Hata Bildir / Ä°letiÅŸim:</p>
        <b style="color:#38bdf8; font-size:14px;">istanbulhava041@gmail.com</b>
    </div>
</div>

<div class="container">
    <div style="display: flex; justify-content: space-between; align-items: center; padding: 5px;">
        <button onclick="toggleM()" style="background:none; border:1px solid #38bdf8; color:#38bdf8; padding:8px 18px; border-radius:10px; font-weight:bold; cursor:pointer;">â˜° MENÃœ</button>
        <div id="clock" style="font-weight:bold; color:#00f2ff; font-size:18px;">00:00</div>
    </div>

    <div class="card">
        <select id="sel" onchange="getData()"></select>
        <div id="loc" style="text-align:center; font-size:12px; letter-spacing:3px; opacity:0.6; font-weight:bold;">Ä°STANBUL</div>
        <div id="temp">--Â°</div>
        <div id="desc">YÃœKLENÄ°YOR...</div>
        
        <div class="stats">
            <div class="stat-box">Hissedilen <b id="feel">--Â°</b></div>
            <div class="stat-box">Nem <b id="hum">%--</b></div>
            <div class="stat-box">RÃ¼zgar <b id="wind">-- km/s</b></div>
            <div class="stat-box">Deniz Suyu <b id="sea">--Â°</b></div>
        </div>
    </div>

    <div class="card">
        <h3 style="font-size:14px; color:#38bdf8; margin-bottom:12px; letter-spacing:1px;">ğŸ“… 7 GÃœNLÃœK TAHMÄ°N</h3>
        <div id="list"></div>
    </div>
</div>

<script>
const dists = {"Adalar":[40.87,29.13],"ArnavutkÃ¶y":[41.18,28.74],"AtaÅŸehir":[40.99,29.11],"AvcÄ±lar":[40.98,28.71],"BaÄŸcÄ±lar":[41.03,28.83],"BahÃ§elievler":[40.99,28.86],"BakÄ±rkÃ¶y":[40.97,28.87],"BaÅŸakÅŸehir":[41.09,28.80],"BayrampaÅŸa":[41.04,28.89],"BeÅŸiktaÅŸ":[41.04,29.00],"Beykoz":[41.11,29.09],"BeylikdÃ¼zÃ¼":[40.99,28.64],"BeyoÄŸlu":[41.03,28.97],"BÃ¼yÃ¼kÃ§ekmece":[41.02,28.59],"Ã‡atalca":[41.14,28.46],"Ã‡ekmekÃ¶y":[41.04,29.21],"Esenler":[41.04,28.87],"Esenyurt":[41.03,28.67],"EyÃ¼psultan":[41.04,28.93],"Fatih":[41.01,28.94],"GaziosmanpaÅŸa":[41.05,28.91],"GÃ¼ngÃ¶ren":[41.02,28.87],"KadÄ±kÃ¶y":[40.99,29.02],"KaÄŸÄ±thane":[41.08,28.97],"Kartal":[40.89,29.19],"KÃ¼Ã§Ã¼kÃ§ekmece":[41.00,28.77],"Maltepe":[40.93,29.14],"Pendik":[40.87,29.23],"Sancaktepe":[41.00,29.23],"SarÄ±yer":[41.16,29.05],"Silivri":[41.07,28.24],"Sultanbeyli":[40.96,29.26],"Sultangazi":[41.10,28.87],"Åile":[41.17,29.61],"ÅiÅŸli":[41.06,28.98],"Tuzla":[40.82,29.30],"Ãœmraniye":[41.03,29.10],"ÃœskÃ¼dar":[41.02,29.01],"Zeytinburnu":[40.99,28.90]};
const wMap = {0:"â˜€ï¸ AÃ§Ä±k", 1:"ğŸŒ¤ï¸ Az Bulutlu", 2:"â›… ParÃ§alÄ± Bulutlu", 3:"â˜ï¸ Ã‡ok Bulutlu", 45:"ğŸŒ«ï¸ Sisli", 51:"ğŸŒ§ï¸ Ã‡isenti", 61:"ğŸŒ§ï¸ YaÄŸmurlu", 71:"â„ï¸ KarlÄ±", 95:"âš¡ GÃ¶k GÃ¼rÃ¼ltÃ¼lÃ¼"};

function toggleM() { const m = document.getElementById('menu'); m.style.display = m.style.display === 'block' ? 'none' : 'block'; }

window.onload = () => {
    const s = document.getElementById("sel");
    Object.keys(dists).sort((a,b)=>a.localeCompare(b,'tr')).forEach(d => s.add(new Option(d, d)));
    s.value = "Fatih";
    getData();
    setInterval(() => {
        document.getElementById('clock').innerText = new Date().toLocaleTimeString('tr-TR',{hour:'2-digit',minute:'2-digit'});
    }, 1000);
};

async function getData() {
    const d = document.getElementById("sel").value;
    const [la, lo] = dists[d];
    document.getElementById("loc").innerText = d.toUpperCase();

    try {
        const url = `https://api.open-meteo.com/v1/forecast?latitude=${la}&longitude=${lo}&current=temperature_2m,relative_humidity_2m,apparent_temperature,weather_code,wind_speed_10m&daily=weather_code,temperature_2m_max,temperature_2m_min&timezone=auto`;
        const res = await fetch(url);
        const data = await res.json();

        // Ãœst Bilgiler
        document.getElementById("temp").innerText = Math.round(data.current.temperature_2m) + "Â°";
        document.getElementById("feel").innerText = Math.round(data.current.apparent_temperature) + "Â°";
        document.getElementById("hum").innerText = "%" + data.current.relative_humidity_2m;
        document.getElementById("wind").innerText = Math.round(data.current.wind_speed_10m) + " km/s";
        document.getElementById("desc").innerText = (wMap[data.current.weather_code] || "AÃ§Ä±k").toUpperCase();
        
        // Deniz Suyu (Tahmini: Mevsime gÃ¶re sabit algoritma + hava etkisi)
        const month = new Date().getMonth();
        const baseSea = [9, 8, 9, 11, 15, 20, 24, 25, 23, 19, 15, 12][month];
        document.getElementById("sea").innerText = baseSea + "Â°";

        // Arka Plan
        const hr = new Date().getHours();
        const b = document.getElementById("bg");
        if(hr > 19 || hr < 7) b.style.background = "#020617";
        else if(data.current.weather_code >= 61) b.style.background = "#1e293b";
        else b.style.background = "#0ea5e9";

        // Liste
        const list = document.getElementById("list");
        list.innerHTML = "";
        const days = ["Pazar", "Pzt", "Sal", "Ã‡ar", "Per", "Cum", "Cmt"];
        data.daily.time.forEach((t, i) => {
            const dn = i === 0 ? "BugÃ¼n" : days[new Date(t).getDay()];
            const icon = (wMap[data.daily.weather_code[i]] || "â˜€ï¸").split(' ')[0];
            list.innerHTML += `<div class="row"><b>${dn}</b><span style="font-size:24px;">${icon}</span><span><b>${Math.round(data.daily.temperature_2m_max[i])}Â°</b> / <small style="opacity:0.6">${Math.round(data.daily.temperature_2m_min[i])}Â°</small></span></div>`;
        });
    } catch (e) { document.getElementById("desc").innerText = "HATA!"; }
}
</script>
</body>
</html>
