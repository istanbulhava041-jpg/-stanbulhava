<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Ä°STANBUL HAVA DURUMU</title>
    <style>
        :root { --bg: #020617; --card: rgba(30, 41, 59, 0.9); --accent: #38bdf8; --neon: #00f2ff; --warn: #f43f5e; }
        * { box-sizing: border-box; margin: 0; padding: 0; font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; }
        
        body { background: var(--bg); color: white; min-height: 100vh; display: flex; flex-direction: column; align-items: center; transition: background 0.8s ease; overflow-x: hidden; }
        
        /* Arka Plan DurumlarÄ± */
        body.sunny { background: linear-gradient(180deg, #0ea5e9, #020617) !important; }
        body.cloudy { background: linear-gradient(180deg, #475569, #020617) !important; }
        body.rainy { background: linear-gradient(180deg, #1e293b, #020617) !important; }
        body.night { background: linear-gradient(180deg, #0f172a, #000000) !important; }

        .navbar { width: 100%; padding: 15px; display: flex; justify-content: space-between; align-items: center; background: rgba(15, 23, 42, 0.95); border-bottom: 2px solid var(--neon); position: sticky; top: 0; z-index: 1000; }
        .container { width: 100%; max-width: 450px; padding: 15px; display: flex; flex-direction: column; gap: 15px; }
        .glass { background: var(--card); backdrop-filter: blur(15px); border: 1px solid rgba(255, 255, 255, 0.1); border-radius: 20px; padding: 20px; box-shadow: 0 8px 32px rgba(0,0,0,0.3); }
        
        #temp-display { font-size: 85px; font-weight: 900; text-align: center; margin: 10px 0; letter-spacing: -3px; }
        #desc-display { text-align: center; color: var(--neon); font-weight: bold; font-size: 22px; text-transform: uppercase; }
        
        select { width: 100%; padding: 15px; border-radius: 15px; background: #1e293b; color: white; border: 2px solid var(--accent); font-size: 18px; font-weight: bold; outline: none; appearance: none; text-align: center; cursor: pointer; }

        .scroll-x { display: flex; gap: 12px; overflow-x: auto; padding: 5px 0 15px 0; scrollbar-width: none; }
        .scroll-x::-webkit-scrollbar { display: none; }
        .hour-box { min-width: 70px; text-align: center; background: rgba(255,255,255,0.05); padding: 12px; border-radius: 15px; border: 1px solid rgba(0,242,255,0.1); }

        .day-item { display: flex; justify-content: space-between; align-items: center; padding: 15px 0; border-bottom: 1px solid rgba(255,255,255,0.1); }
        .day-item:last-child { border: none; }

        /* Yan MenÃ¼ */
        .sidebar { position: fixed; top: 0; left: -100%; width: 280px; height: 100%; background: #0f172a; z-index: 2000; transition: 0.4s; padding: 30px; border-right: 3px solid var(--neon); }
        .sidebar.open { left: 0; }
        .menu-link { width: 100%; padding: 15px; margin-bottom: 15px; border-radius: 12px; border: 1px solid var(--accent); background: rgba(56,189,248,0.1); color: white; text-decoration: none; display: block; text-align: center; font-weight: bold; }
    </style>
</head>
<body id="mainBody">

<div id="sideNav" class="sidebar">
    <button onclick="navToggle()" style="float:right; background:none; border:none; color:var(--warn); font-size:40px;">&times;</button>
    <h2 style="color:var(--neon); margin: 40px 0 20px 0;">Ä°STANBUL PORTAL</h2>
    <a href="https://uym.ibb.gov.tr/" target="_blank" class="menu-link">ğŸš— CanlÄ± Trafik</a>
    <a href="https://www.iski.gov.tr" target="_blank" class="menu-link">ğŸ’§ Baraj Doluluk</a>
    <a href="https://www.istanbuleczaciodasi.org.tr/nobetci-eczane" target="_blank" class="menu-link">ğŸ¥ NÃ¶betÃ§i Eczaneler</a>
    <div style="margin-top: 50px; border-top: 1px solid rgba(255,255,255,0.1); padding-top: 25px;">
        <p style="opacity:0.6; font-size: 12px;">Ä°letiÅŸim:</p>
        <b style="color:var(--accent); font-size:14px;">istanbulhava041@gmail.com</b>
    </div>
</div>

<div class="navbar">
    <button onclick="navToggle()" style="background:none; border:none; color:var(--neon); font-size:30px;">â˜°</button>
    <div id="liveClock" style="font-weight: bold; color: #fbbf24; font-size: 18px;">00:00</div>
    <b style="color:var(--neon)">HAVA v30</b>
</div>

<div class="container">
    <div class="glass"><select id="districtSelect" onchange="getWeatherData()"></select></div>

    <div class="glass">
        <div id="cityLabel" style="text-align:center; font-size:14px; letter-spacing:4px; opacity:0.8; font-weight:bold;">Ä°STANBUL</div>
        <div id="temp-display">--Â°</div>
        <div id="desc-display">YÃœKLENÄ°YOR...</div>
    </div>

    <div class="glass">
        <p style="font-size:12px; color:var(--accent); margin-bottom:12px; font-weight:bold;">ğŸ•’ SAATLÄ°K TAHMÄ°N</p>
        <div class="scroll-x" id="hourlyList"></div>
    </div>

    <div class="glass">
        <p style="font-size:12px; color:var(--accent); margin-bottom:12px; font-weight:bold;">ğŸ“… 7 GÃœNLÃœK TAHMÄ°N</p>
        <div id="weeklyList"></div>
    </div>
</div>

<script>
const districtCoords = {"Adalar":[40.87,29.13],"ArnavutkÃ¶y":[41.18,28.74],"AtaÅŸehir":[40.99,29.11],"AvcÄ±lar":[40.98,28.71],"BaÄŸcÄ±lar":[41.03,28.83],"BahÃ§elievler":[40.99,28.86],"BakÄ±rkÃ¶y":[40.97,28.87],"BaÅŸakÅŸehir":[41.09,28.80],"BayrampaÅŸa":[41.04,28.89],"BeÅŸiktaÅŸ":[41.04,29.00],"Beykoz":[41.11,29.09],"BeylikdÃ¼zÃ¼":[40.99,28.64],"BeyoÄŸlu":[41.03,28.97],"BÃ¼yÃ¼kÃ§ekmece":[41.02,28.59],"Ã‡atalca":[41.14,28.46],"Ã‡ekmekÃ¶y":[41.04,29.21],"Esenler":[41.04,28.87],"Esenyurt":[41.03,28.67],"EyÃ¼psultan":[41.04,28.93],"Fatih":[41.01,28.94],"GaziosmanpaÅŸa":[41.05,28.91],"GÃ¼ngÃ¶ren":[41.02,28.87],"KadÄ±kÃ¶y":[40.99,29.02],"KaÄŸÄ±thane":[41.08,28.97],"Kartal":[40.89,29.19],"KÃ¼Ã§Ã¼kÃ§ekmece":[41.00,28.77],"Maltepe":[40.93,29.14],"Pendik":[40.87,29.23],"Sancaktepe":[41.00,29.23],"SarÄ±yer":[41.16,29.05],"Silivri":[41.07,28.24],"Sultanbeyli":[40.96,29.26],"Sultangazi":[41.10,28.87],"Åile":[41.17,29.61],"ÅiÅŸli":[41.06,28.98],"Tuzla":[40.82,29.30],"Ãœmraniye":[41.03,29.10],"ÃœskÃ¼dar":[41.02,29.01],"Zeytinburnu":[40.99,28.90]};
const conditionMap = {0:"â˜€ï¸ AÃ§Ä±k", 1:"ğŸŒ¤ï¸ AÃ§Ä±k", 2:"â›… Bulutlu", 3:"â˜ï¸ KapalÄ±", 45:"ğŸŒ«ï¸ Sisli", 61:"ğŸŒ§ï¸ YaÄŸmurlu", 71:"â„ï¸ KarlÄ±", 95:"âš¡ FÄ±rtÄ±na"};

function navToggle() { document.getElementById('sideNav').classList.toggle('open'); }

window.onload = function() {
    const sel = document.getElementById("districtSelect");
    Object.keys(districtCoords).sort((a,b)=>a.localeCompare(b,'tr')).forEach(d => sel.add(new Option(d, d)));
    sel.value = "Fatih";
    getWeatherData();
    setInterval(() => {
        document.getElementById('liveClock').innerText = new Date().toLocaleTimeString('tr-TR',{hour:'2-digit',minute:'2-digit'});
    }, 1000);
};

async function getWeatherData() {
    const name = document.getElementById("districtSelect").value;
    const [lt, ln] = districtCoords[name];
    document.getElementById("cityLabel").innerText = name.toUpperCase();

    try {
        const api = `https://api.open-meteo.com/v1/forecast?latitude=${lt}&longitude=${ln}&current=temperature_2m,weather_code&hourly=temperature_2m,weather_code&daily=weather_code,temperature_2m_max,temperature_2m_min&timezone=auto`;
        const res = await fetch(api);
        const data = await res.json();

        // GÃ¼ncel
        document.getElementById("temp-display").innerText = Math.round(data.current.temperature_2m) + "Â°";
        document.getElementById("desc-display").innerText = conditionMap[data.current.weather_code] || "AÃ‡IK";

        // Arka Plan Kontrol
        const hour = new Date().getHours();
        const body = document.getElementById("mainBody");
        body.className = ""; 
        if(hour > 19 || hour < 7) body.classList.add("night");
        else if(data.current.weather_code >= 61) body.classList.add("rainy");
        else if(data.current.weather_code >= 1) body.classList.add("cloudy");
        else body.classList.add("sunny");

        // Saatlik Liste
        const hL = document.getElementById("hourlyList");
        hL.innerHTML = "";
        for(let i=0; i<24; i++) {
            hL.innerHTML += `<div class="hour-box"><small>${i}:00</small><div style="font-size:24px; margin:5px 0">${conditionMap[data.hourly.weather_code[i]].split(' ')[0]}</div><b>${Math.round(data.hourly.temperature_2m[i])}Â°</b></div>`;
        }

        // HaftalÄ±k Liste (KESÄ°N 7 GÃœN)
        const wL = document.getElementById("weeklyList");
        wL.innerHTML = "";
        const gunAdlari = ["Pazar", "Pazartesi", "SalÄ±", "Ã‡arÅŸamba", "PerÅŸembe", "Cuma", "Cumartesi"];
        data.daily.time.forEach((t, i) => {
            const dt = new Date(t);
            wL.innerHTML += `
                <div class="day-item">
                    <span style="font-weight:bold; width:100px">${i==0?'BugÃ¼n':gunAdlari[dt.getDay()]}</span>
                    <span style="font-size:28px">${conditionMap[data.daily.weather_code[i]].split(' ')[0]}</span>
                    <span style="width:100px; text-align:right">
                        <b>${Math.round(data.daily.temperature_2m_max[i])}Â°</b> 
                        <small style="opacity:0.5; margin-left:5px">${Math.round(data.daily.temperature_2m_min[i])}Â°</small>
                    </span>
                </div>`;
        });

    } catch(err) {
        document.getElementById("desc-display").innerText = "BAÄLANTI HATASI!";
    }
}
</script>
</body>
</html>
